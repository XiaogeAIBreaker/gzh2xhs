# 变更影响分析报告

## 范围

- 模块：控制器、用例、图片管线、AI 调用、指标与 A/B、中间件、测试与 CI

## 影响

- 性能：渲染与调用链缩短；吞吐与稳定性提升
- 兼容：新增 `variant` 入参，默认不影响现有调用
- 运维：CI 增加 Sonar 扫描；日志多输出指标 JSON 行

## 风险

- 外部 API 超时/波动；Playwright 运行环境；并发队列饱和

## 缓解与回滚

- 超时与重试、失败快速回退到 sharp；开关与分阶段发布；回滚靠 git tag 与 CI

## 依赖

- Node 18/20，playwright chromium，sharp，ioredis（可选）
