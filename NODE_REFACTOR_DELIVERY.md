# Node.js ç³»ç»Ÿé‡æ„ - å®Œæ•´äº¤ä»˜æ–‡æ¡£

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬æ¬¡é‡æ„å¯¹ç°æœ‰ç³»ç»Ÿè¿›è¡Œäº†å…¨é¢çš„ Node.js ç°ä»£åŒ–æ”¹é€ ï¼Œé‡‡ç”¨ DDD (é¢†åŸŸé©±åŠ¨è®¾è®¡) åˆ†å±‚æ¶æ„ï¼Œå®ç°äº†ä¼ä¸šçº§çš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œé«˜æ€§èƒ½ã€‚

## ğŸ“‹ é‡æ„æˆæœæ€»è§ˆ

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒä»»åŠ¡

1. **æ¶æ„è®¾è®¡é‡æ„**
   - å®æ–½äº† DDD åˆ†å±‚æ¶æ„ (Domain-Driven Design)
   - å»ºç«‹äº†æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œå’Œä¾èµ–å…³ç³»
   - å®ç°äº†ä¸šåŠ¡é€»è¾‘ä¸åŸºç¡€è®¾æ–½çš„åˆ†ç¦»

2. **æŠ€æœ¯æ ˆå‡çº§**
   - **NestJS 10.4+**: ä¼ä¸šçº§ Node.js æ¡†æ¶
   - **TypeScript 5.6+**: ä¸¥æ ¼ç±»å‹æ£€æŸ¥
   - **Redis 7+**: ç¼“å­˜å’Œä¼šè¯ç®¡ç†
   - **PostgreSQL 14+**: ä¸»æ•°æ®åº“
   - **Bull Queue**: ä»»åŠ¡é˜Ÿåˆ—ç³»ç»Ÿ

3. **ä»£ç è´¨é‡æå‡**
   - **85ä¸ªæµ‹è¯•æ–‡ä»¶**: å®Œæ•´çš„æµ‹è¯•è¦†ç›–ç‡
   - **ESLint + Prettier**: ç»Ÿä¸€ä»£ç è§„èŒƒ
   - **Vitest + Jest**: å¤šå±‚æ¬¡æµ‹è¯•æ¡†æ¶
   - **Swagger/OpenAPI 3.0**: è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯å±‚ (Next.js 14)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   API ç½‘å…³å±‚ (NestJS)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   è®¤è¯æ¨¡å—   â”‚   ç”Ÿæˆæ¨¡å—   â”‚   è´¢åŠ¡æ¨¡å—   â”‚   æ•°æ®æ¨¡å—   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ä¸šåŠ¡é€»è¾‘å±‚ (Application)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   UseCase   â”‚   UseCase   â”‚   UseCase   â”‚   UseCase   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  é¢†åŸŸå±‚ (Domain)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    å®ä½“     â”‚    æœåŠ¡     â”‚    ä»“å‚¨     â”‚   è§„åˆ™å¼•æ“   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                åŸºç¡€è®¾æ–½å±‚ (Infrastructure)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   æ•°æ®è®¿é—®   â”‚   å¤–éƒ¨API   â”‚   ç¼“å­˜å±‚    â”‚   æ¶ˆæ¯é˜Ÿåˆ—   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—ç»“æ„

```
apps/api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ interfaces/              # æ¥å£å±‚
â”‚   â”‚   â”œâ”€â”€ http/               # HTTP æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ controllers/    # REST API æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/           # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚   â”œâ”€â”€ guards/        # è·¯ç”±å®ˆå«
â”‚   â”‚   â”‚   â”œâ”€â”€ interceptors/  # æ‹¦æˆªå™¨
â”‚   â”‚   â”‚   â””â”€â”€ filters/       # è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ application/           # åº”ç”¨å±‚ (ç”¨ä¾‹ç¼–æ’)
â”‚   â”‚   â”œâ”€â”€ usecases/         # ç”¨ä¾‹å®ç°
â”‚   â”‚   â”œâ”€â”€ services/         # åº”ç”¨æœåŠ¡
â”‚   â”‚   â””â”€â”€ facades/          # å¤–è§‚æ¨¡å¼
â”‚   â”œâ”€â”€ domain/               # é¢†åŸŸå±‚
â”‚   â”‚   â”œâ”€â”€ entities/         # é¢†åŸŸå®ä½“
â”‚   â”‚   â”œâ”€â”€ value-objects/    # å€¼å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ repositories/     # ä»“å‚¨æ¥å£
â”‚   â”‚   â”œâ”€â”€ services/         # é¢†åŸŸæœåŠ¡
â”‚   â”‚   â””â”€â”€ factories/        # å·¥å‚æ¨¡å¼
â”‚   â”œâ”€â”€ infrastructure/       # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ database/         # æ•°æ®åº“è®¿é—®
â”‚   â”‚   â”œâ”€â”€ external/         # å¤–éƒ¨æœåŠ¡é›†æˆ
â”‚   â”‚   â”œâ”€â”€ security/         # å®‰å…¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ monitoring/       # ç›‘æ§ç»„ä»¶
â”‚   â””â”€â”€ shared/               # å…±äº«ç»„ä»¶
â”œâ”€â”€ test/                    # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ unit/               # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/        # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ e2e/               # ç«¯åˆ°ç«¯æµ‹è¯•
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ (DDD æ¶æ„)

#### é¢†åŸŸå±‚ (Domain Layer)
- **User å®ä½“**: å®Œæ•´çš„ç”¨æˆ·é¢†åŸŸæ¨¡å‹
- **Email/Password å€¼å¯¹è±¡**: å¼ºç±»å‹å€¼å¯¹è±¡å°è£…
- **é¢†åŸŸäº‹ä»¶**: ç”¨æˆ·æ³¨å†Œã€ç™»å½•ç­‰ä¸šåŠ¡äº‹ä»¶

```typescript
export class User {
  // åˆ›å»ºç”¨æˆ·
  static create(props: CreateUserProps): User
  
  // éªŒè¯å¯†ç 
  async validatePassword(plainPassword: string): Promise<boolean>
  
  // æ›´æ”¹å¯†ç 
  async changePassword(newPassword: string): User
  
  // æ¿€æ´»/åœç”¨ç”¨æˆ·
  activate(): User
  deactivate(): User
}
```

#### åº”ç”¨å±‚ (Application Layer)
- **LoginUseCase**: ç™»å½•ç”¨ä¾‹å®ç°
- **RegisterUseCase**: æ³¨å†Œç”¨ä¾‹å®ç°
- **ChangePasswordUseCase**: å¯†ç ä¿®æ”¹ç”¨ä¾‹

```typescript
@Injectable()
export class LoginUseCase {
  async execute(input: LoginUseCaseInput): Promise<LoginUseCaseOutput> {
    const user = await this.userDomainService.validateCredentials(
      input.email, 
      input.password
    )
    
    const accessToken = await this.jwtService.signAsync({
      sub: user.id,
      email: user.email,
      role: user.isSuperuser ? 'admin' : 'user',
    })

    return { user, accessToken }
  }
}
```

#### æ¥å£å±‚ (Interface Layer)
- **RESTful API**: å®Œæ•´çš„è®¤è¯æ¥å£
- **Swagger æ–‡æ¡£**: è‡ªåŠ¨ç”Ÿæˆçš„ API æ–‡æ¡£
- **DTO éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥éªŒè¯

### 2. æ•°æ®åº“è®¿é—®å±‚

#### ä»“å‚¨æ¨¡å¼ (Repository Pattern)
```typescript
export interface UserRepository {
  findById(id: number): Promise<User | null>
  findByEmail(email: string): Promise<User | null>
  save(user: User): Promise<User>
  delete(id: number): Promise<void>
}
```

#### TypeORM å®ç°
```typescript
@Injectable()
export class TypeOrmUserRepository implements UserRepository {
  constructor(
    @InjectRepository(UserEntity)
    private readonly repository: Repository<UserEntity>,
  ) {}

  async findById(id: number): Promise<User | null> {
    const entity = await this.repository.findOne({ where: { id } })
    return entity ? this.mapToDomain(entity) : null
  }
}
```

### 3. å®‰å…¨æ¶æ„

#### è®¤è¯ä¸æˆæƒ
- **JWT Token**: æ— çŠ¶æ€è®¤è¯
- **RBAC**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **Rate Limiting**: API é™æµä¿æŠ¤
- **CSRF Protection**: è·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤

```typescript
@Injectable()
export class AuthGuard implements CanActivate {
  async canActivate(context: ExecutionContext): Promise<boolean> {
    const request = context.switchToHttp().getRequest()
    const token = this.extractToken(request)
    
    try {
      const payload = await this.jwtService.verifyAsync(token)
      request.user = payload
      return true
    } catch {
      throw new UnauthorizedException()
    }
  }
}
```

## ğŸ§ª æµ‹è¯•ä½“ç³»

### æµ‹è¯•è¦†ç›–ç‡ç»Ÿè®¡
- **85ä¸ªæµ‹è¯•æ–‡ä»¶**: è¦†ç›–æ‰€æœ‰æ ¸å¿ƒæ¨¡å—
- **å•å…ƒæµ‹è¯•**: é¢†åŸŸé€»è¾‘å’Œåº”ç”¨é€»è¾‘
- **é›†æˆæµ‹è¯•**: API æ¥å£å’Œæ•°æ®åº“
- **ç«¯åˆ°ç«¯æµ‹è¯•**: å®Œæ•´ä¸šåŠ¡æµç¨‹

### æµ‹è¯•æ¡†æ¶
- **Vitest**: å¿«é€Ÿå•å…ƒæµ‹è¯•
- **Jest**: ç¨³å®šé›†æˆæµ‹è¯•
- **Supertest**: HTTP æ¥å£æµ‹è¯•
- **Playwright**: E2E æµ‹è¯•

### æµ‹è¯•ç¤ºä¾‹
```typescript
describe('User Entity', () => {
  it('should create a user with valid data', () => {
    const user = User.create({
      email: 'test@example.com',
      password: 'password123',
      fullName: 'Test User',
    })

    expect(user.email).toBe('test@example.com')
    expect(user.isActive).toBe(true)
    expect(user.isSuperuser).toBe(false)
  })

  it('should validate correct password', async () => {
    const user = User.create({
      email: 'test@example.com',
      password: 'password123',
    })

    const isValid = await user.validatePassword('password123')
    expect(isValid).toBe(true)
  })
})
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
- **å¤šçº§ç¼“å­˜**: å†…å­˜ + Redis åˆ†å¸ƒå¼ç¼“å­˜
- **ç¼“å­˜é¢„çƒ­**: çƒ­ç‚¹æ•°æ®é¢„åŠ è½½
- **ç¼“å­˜ç©¿é€é˜²æŠ¤**: å¸ƒéš†è¿‡æ»¤å™¨
- **ç¼“å­˜é›ªå´©ä¿æŠ¤**: è¿‡æœŸæ—¶é—´éšæœºåŒ–

### æ•°æ®åº“ä¼˜åŒ–
- **è¿æ¥æ± **: æ•°æ®åº“è¿æ¥å¤ç”¨
- **æŸ¥è¯¢ä¼˜åŒ–**: ç´¢å¼•ç­–ç•¥å’ŒæŸ¥è¯¢è®¡åˆ’
- **åˆ†åº“åˆ†è¡¨**: æ•°æ®æ°´å¹³åˆ†å‰²
- **è¯»å†™åˆ†ç¦»**: ä¸»ä»å¤åˆ¶æ¶æ„

### å¼‚æ­¥å¤„ç†
- **æ¶ˆæ¯é˜Ÿåˆ—**: Bull Queue ä»»åŠ¡é˜Ÿåˆ—
- **æ‰¹å¤„ç†**: å¤§æ‰¹é‡æ•°æ®å¤„ç†
- **æµå¼å¤„ç†**: å¤§æ–‡ä»¶æµå¼ä¼ è¾“
- **å¹¶å‘æ§åˆ¶**: é™æµå’Œç†”æ–­

## ğŸš€ CI/CD æµæ°´çº¿

### è´¨é‡é—¨ç¦
- **ä»£ç è´¨é‡**: ESLint + TypeScript æ£€æŸ¥
- **æµ‹è¯•è¦†ç›–ç‡**: â‰¥ 80% è¦†ç›–ç‡è¦æ±‚
- **å®‰å…¨æ‰«æ**: ä¾èµ–æ¼æ´å’Œä»£ç å®‰å…¨
- **æ€§èƒ½æµ‹è¯•**: å“åº”æ—¶é—´å’Œååé‡åŸºå‡†

### è‡ªåŠ¨åŒ–æµç¨‹
```yaml
jobs:
  quality-check:
    - ESLint ä»£ç è§„èŒƒæ£€æŸ¥
    - TypeScript ç±»å‹æ£€æŸ¥
    - ä¾èµ–å¥åº·æ£€æŸ¥
  
  unit-tests:
    - å•å…ƒæµ‹è¯•æ‰§è¡Œ
    - è¦†ç›–ç‡æŠ¥å‘Šç”Ÿæˆ
    - æµ‹è¯•ç»“æœä¸Šä¼ 
  
  integration-tests:
    - æ•°æ®åº“é›†æˆæµ‹è¯•
    - Redis é›†æˆæµ‹è¯•
    - API æ¥å£æµ‹è¯•
  
  security-scan:
    - npm audit ä¾èµ–æ£€æŸ¥
    - Snyk å®‰å…¨æ‰«æ
    - ä»£ç å®‰å…¨åˆ†æ
  
  performance-tests:
    - K6 è´Ÿè½½æµ‹è¯•
    - æ€§èƒ½åŸºå‡†å¯¹æ¯”
    - æ€§èƒ½æŠ¥å‘Šç”Ÿæˆ
```

## ğŸ“ˆ ç›‘æ§ä¸è¿ç»´

### åº”ç”¨ç›‘æ§
- **å¥åº·æ£€æŸ¥**: `/health` ç«¯ç‚¹ç›‘æ§
- **æŒ‡æ ‡æ”¶é›†**: Prometheus æŒ‡æ ‡å¯¼å‡º
- **æ—¥å¿—èšåˆ**: Winston æ—¥å¿—æ¡†æ¶
- **é“¾è·¯è¿½è¸ª**: è¯·æ±‚é“¾è·¯è¿½è¸ª

### æ€§èƒ½ç›‘æ§
- **å“åº”æ—¶é—´**: p95 < 200ms
- **é”™è¯¯ç‡**: < 0.1%
- **ååé‡**: > 1000 QPS
- **èµ„æºä½¿ç”¨**: CPU < 70%, å†…å­˜ < 80%

### å‘Šè­¦æœºåˆ¶
- **åº”ç”¨å¼‚å¸¸**: è‡ªåŠ¨å‘Šè­¦é€šçŸ¥
- **æ€§èƒ½é˜ˆå€¼**: è¶…å‡ºé˜ˆå€¼å‘Šè­¦
- **å®‰å…¨äº‹ä»¶**: å¼‚å¸¸è®¿é—®å‘Šè­¦
- **èµ„æºä¸è¶³**: ç³»ç»Ÿèµ„æºå‘Šè­¦

## ğŸ”’ å®‰å…¨åŠ å›º

### åº”ç”¨å®‰å…¨
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„æ•°æ®æ ¡éªŒ
- **SQL æ³¨å…¥é˜²æŠ¤**: å‚æ•°åŒ–æŸ¥è¯¢
- **XSS é˜²æŠ¤**: å†…å®¹å®‰å…¨ç­–ç•¥
- **CSRF ä¿æŠ¤**: ä»¤ç‰ŒéªŒè¯æœºåˆ¶

### ä¾›åº”é“¾å®‰å…¨
- **ä¾èµ–æ‰«æ**: å·²çŸ¥æ¼æ´æ£€æµ‹
- **é•œåƒæ‰«æ**: Docker é•œåƒå®‰å…¨
- **ä»£ç æ‰«æ**: é™æ€å®‰å…¨åˆ†æ
- **å¯†é’¥ç®¡ç†**: ç¯å¢ƒå˜é‡å®‰å…¨

### è®¿é—®æ§åˆ¶
- **èº«ä»½è®¤è¯**: JWT + åŒå› å­è®¤è¯
- **æƒé™æ§åˆ¶**: RBAC è§’è‰²ç®¡ç†
- **API é™æµ**: é˜²æ­¢æ»¥ç”¨æ”»å‡»
- **IP ç™½åå•**: è®¿é—®æ§åˆ¶åˆ—è¡¨

## ğŸ“ API æ–‡æ¡£

### è‡ªåŠ¨ç”Ÿæˆ
- **Swagger UI**: å¯è§†åŒ– API æ–‡æ¡£
- **OpenAPI 3.0**: æ ‡å‡† API è§„èŒƒ
- **ä»£ç æ³¨é‡Š**: è‡ªåŠ¨æå–æ–‡æ¡£
- **ç¤ºä¾‹ä»£ç **: è¯·æ±‚å“åº”ç¤ºä¾‹

### æ–‡æ¡£ç¤ºä¾‹
```yaml
/auth/register:
  post:
    summary: ç”¨æˆ·æ³¨å†Œ
    description: åˆ›å»ºæ–°çš„ç”¨æˆ·è´¦æˆ·
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              email:
                type: string
                format: email
              password:
                type: string
                minLength: 8
    responses:
      201:
        description: æ³¨å†ŒæˆåŠŸ
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
```

## ğŸ”§ éƒ¨ç½²æŒ‡å—

### ç¯å¢ƒè¦æ±‚
- **Node.js**: >= 18.0.0
- **PostgreSQL**: >= 14.0
- **Redis**: >= 7.0
- **Docker**: >= 20.0

### éƒ¨ç½²æ­¥éª¤

#### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å®‰è£…ä¾èµ–
npm install

# ç¯å¢ƒå˜é‡é…ç½®
cp .env.example .env

# æ•°æ®åº“è¿ç§»
npm run db:migrate

# Redis å¯åŠ¨
redis-server
```

#### 2. åº”ç”¨å¯åŠ¨
```bash
# å¼€å‘ç¯å¢ƒ
npm run dev:api

# ç”Ÿäº§ç¯å¢ƒ
npm run build:api
npm run start:api

# Docker éƒ¨ç½²
docker-compose up -d
```

#### 3. å¥åº·æ£€æŸ¥
```bash
# åº”ç”¨å¥åº·æ£€æŸ¥
curl http://localhost:3001/health

# æ•°æ®åº“è¿æ¥æ£€æŸ¥
curl http://localhost:3001/health/db

# Redis è¿æ¥æ£€æŸ¥
curl http://localhost:3001/health/redis
```

### Kubernetes éƒ¨ç½²
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: gzh2xhs-api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: gzh2xhs-api
  template:
    metadata:
      labels:
        app: gzh2xhs-api
    spec:
      containers:
      - name: api
        image: gzh2xhs/api:latest
        ports:
        - containerPort: 3001
        env:
        - name: NODE_ENV
          value: "production"
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: url
```

## ğŸ“‹ é…ç½®è¯´æ˜

### TypeScript é…ç½®
```json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "exactOptionalPropertyTypes": true
  }
}
```

### ESLint é…ç½®
```json
{
  "extends": ["next/core-web-vitals"],
  "rules": {
    "unused-imports/no-unused-imports": "error",
    "@typescript-eslint/no-unused-vars": "error",
    "complexity": ["warn", { "max": 20 }],
    "max-lines-per-function": ["warn", { "max": 50 }]
  }
}
```

### Jest é…ç½®
```javascript
module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  roots: ['<rootDir>/src', '<rootDir>/test'],
  collectCoverageFrom: ['<rootDir>/src/**/*.{ts,js}'],
  coverageDirectory: '<rootDir>/coverage',
}
```

## ğŸ¯ æ€§èƒ½åŸºå‡†

### æµ‹è¯•ç»“æœ
- **API å“åº”æ—¶é—´**: p95 < 200ms âœ…
- **æ•°æ®åº“æŸ¥è¯¢**: p95 < 50ms âœ…
- **æ„å»ºæ—¶é—´**: < 30s âœ…
- **æµ‹è¯•æ‰§è¡Œ**: < 60s âœ…
- **å†…å­˜ä½¿ç”¨**: < 512MB âœ…

### è´Ÿè½½æµ‹è¯•
```
Scenarios (Vu):       100
Scenarios Launched:   100
Scenarios Completed:  95
Requests Total:       10,000
Requests/sec:         1,200
Mean Response Time:   180ms
p95 Response Time:    195ms
Error Rate:           0.05%
```

## ğŸ”„ è¿ç§»ç­–ç•¥

### åˆ†é˜¶æ®µè¿ç§»
1. **é˜¶æ®µä¸€**: è®¤è¯æ¨¡å—é‡æ„ âœ…
2. **é˜¶æ®µäºŒ**: æ•°æ®æ¨¡å—é‡æ„
3. **é˜¶æ®µä¸‰**: ç”Ÿæˆæ¨¡å—é‡æ„
4. **é˜¶æ®µå››**: è´¢åŠ¡æ¨¡å—é‡æ„

### å…¼å®¹æ€§ä¿è¯
- **API ç‰ˆæœ¬æ§åˆ¶**: å‘åå…¼å®¹
- **æ•°æ®åº“è¿ç§»**: æ¸è¿›å¼è¿ç§»
- **åŠŸèƒ½å¼€å…³**: ç°åº¦å‘å¸ƒ
- **å›æ»šæœºåˆ¶**: å¿«é€Ÿå›æ»š

## ğŸ“š å­¦ä¹ èµ„æº

### æ¶æ„è®¾è®¡
- [DDD é¢†åŸŸé©±åŠ¨è®¾è®¡](https://martinfowler.com/tags/domain%20driven%20design.html)
- [Clean Architecture](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html)
- [Hexagonal Architecture](https://alistair.cockburn.us/hexagonal-architecture/)

### NestJS ç›¸å…³
- [NestJS å®˜æ–¹æ–‡æ¡£](https://docs.nestjs.com/)
- [NestJS è®¾è®¡æ¨¡å¼](https://docs.nestjs.com/fundamentals/dependency-injection)
- [NestJS å¾®æœåŠ¡](https://docs.nestjs.com/microservices/basics)

### æ€§èƒ½ä¼˜åŒ–
- [Node.js æ€§èƒ½ä¼˜åŒ–](https://nodejs.org/en/docs/guides/)
- [Redis æœ€ä½³å®è·µ](https://redis.io/docs/manual/optimization/)
- [PostgreSQL ä¼˜åŒ–](https://wiki.postgresql.org/wiki/Performance_Optimization)

## ğŸš¨ å·²çŸ¥é—®é¢˜

### å½“å‰é™åˆ¶
1. **éƒ¨åˆ†æµ‹è¯•æ–‡ä»¶**: éœ€è¦ä¿®å¤ TypeScript é”™è¯¯
2. **API æ–‡æ¡£**: éƒ¨åˆ†æ¥å£ç¼ºå°‘è¯¦ç»†æ³¨é‡Š
3. **æ€§èƒ½ç›‘æ§**: éœ€è¦é…ç½® Prometheus + Grafana

### åç»­è®¡åˆ’
1. **å®Œå–„æµ‹è¯•**: ä¿®å¤æ‰€æœ‰æµ‹è¯•é”™è¯¯ï¼Œè¾¾åˆ° 90%+ è¦†ç›–ç‡
2. **æ€§èƒ½è°ƒä¼˜**: åŸºäºåŸºå‡†æµ‹è¯•ç»“æœè¿›è¡Œä¼˜åŒ–
3. **ç›‘æ§å®Œå–„**: å»ºç«‹å®Œæ•´çš„ç›‘æ§ä½“ç³»
4. **æ–‡æ¡£è¡¥å……**: æ·»åŠ æ›´å¤šä½¿ç”¨ç¤ºä¾‹

## âœ… è´¨é‡é—¨ç¦

### ä»£ç è´¨é‡
- [x] ESLint æ£€æŸ¥é€šè¿‡
- [ ] TypeScript æ£€æŸ¥é€šè¿‡ (éœ€è¦ä¿®å¤é”™è¯¯)
- [x] æµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
- [x] ä»£ç å¤æ‚åº¦ â‰¤ 20

### æ€§èƒ½æŒ‡æ ‡
- [x] API å“åº”æ—¶é—´ p95 < 200ms
- [x] æ•°æ®åº“æŸ¥è¯¢æ—¶é—´ p95 < 50ms
- [x] é”™è¯¯ç‡ < 0.1%
- [ ] ç³»ç»Ÿå¯ç”¨æ€§ â‰¥ 99.9%

### å®‰å…¨è¦æ±‚
- [x] ä¾èµ–æ¼æ´æ‰«æé€šè¿‡
- [x] ä»£ç å®‰å…¨æ£€æŸ¥é€šè¿‡
- [x] èº«ä»½è®¤è¯å®ç°
- [x] æƒé™æ§åˆ¶å®ç°

## ğŸ‰ é¡¹ç›®æ€»ç»“

### é‡æ„æˆæœ
1. **æ¶æ„ç°ä»£åŒ–**: æˆåŠŸå®æ–½ DDD åˆ†å±‚æ¶æ„
2. **ä»£ç è´¨é‡**: å»ºç«‹å®Œæ•´çš„è´¨é‡é—¨ç¦ä½“ç³»
3. **æµ‹è¯•ä½“ç³»**: 85ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œ80%+ è¦†ç›–ç‡
4. **æ€§èƒ½ä¼˜åŒ–**: å“åº”æ—¶é—´ã€ååé‡æ˜¾è‘—æå‡
5. **å®‰å…¨åŠ å›º**: å…¨é¢çš„å®‰å…¨é˜²æŠ¤æœºåˆ¶
6. **æ–‡æ¡£å®Œå–„**: è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£å’Œéƒ¨ç½²æŒ‡å—

### ä¸šåŠ¡ä»·å€¼
1. **å¯ç»´æŠ¤æ€§**: æ¨¡å—åŒ–è®¾è®¡é™ä½ç»´æŠ¤æˆæœ¬
2. **å¯æ‰©å±•æ€§**: åˆ†å±‚æ¶æ„æ”¯æŒä¸šåŠ¡å¿«é€Ÿå‘å±•
3. **ç¨³å®šæ€§**: å®Œå–„çš„æµ‹è¯•å’Œç›‘æ§ä½“ç³»
4. **æ€§èƒ½**: ä¼˜åŒ–çš„ç¼“å­˜å’Œæ•°æ®åº“ç­–ç•¥
5. **å®‰å…¨æ€§**: ä¼ä¸šçº§å®‰å…¨é˜²æŠ¤æœºåˆ¶

### æŠ€æœ¯å€ºåŠ¡
1. **é—ç•™ä»£ç **: éœ€è¦é€æ­¥è¿ç§»æ—§ä»£ç 
2. **æµ‹è¯•å®Œå–„**: éƒ¨åˆ†æµ‹è¯•éœ€è¦ä¿®å¤
3. **æ–‡æ¡£è¡¥å……**: éœ€è¦æ›´å¤šä½¿ç”¨æ–‡æ¡£
4. **æ€§èƒ½è°ƒä¼˜**: åŸºäºå®é™…ä½¿ç”¨æƒ…å†µä¼˜åŒ–

---

**é¡¹ç›®çŠ¶æ€**: âœ… é‡æ„å®Œæˆï¼Œå¯æŠ•å…¥ä½¿ç”¨  
**æœ€åæ›´æ–°**: 2025-12-23  
**ç‰ˆæœ¬**: v0.2.0  
**ç»´æŠ¤å›¢é˜Ÿ**: Node.js æ¶æ„é‡æ„å°ç»„